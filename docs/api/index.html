<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MCEconomy - API</title>
    <link rel="stylesheet" href="../css/home/main.css">
    <link rel="stylesheet" href="../css/partial/header.css">
    <link rel="stylesheet" href="../css/partial/footer.css">
    <link rel="stylesheet" href="../css/share/code.css">
</head>
<body class="night-theme">
    <div id="header-placeholder"></div>

    <main style="max-width: 900px; margin: 40px auto; padding: 0 20px;">
        <h1 style="color: var(--accent-color);">API Module Documentation</h1>
        <p>Learn how to interact with the MCEconomy provider, register subcommands, and handle listeners.</p>

        <section>
        <h2>1. Using the Provider</h2>
        <p>The <code>MCEconomyProvider</code> handles all database operations asynchronously. It now supports multiple account types (e.g., "player", "clan", "guild").</p>
        
        <div class="code-container">
            <div class="code-header">
                <span>Java</span>
                <span>ProviderAccess.java</span>
            </div>
            <pre>
<span class="comment">// 1. Retrieve the Provider Instance</span>
<span class="class-name">MCEconomyProvider</span> provider = <span class="class-name">MCEconomyProvider</span>.<span class="method">getInstance</span>();

<span class="keyword">if</span> (provider != <span class="keyword">null</span>) {
    <span class="comment">// --- 2. GET BALANCE ---</span>
    <span class="comment">// Example: Get a Clan's "gold" balance</span>
    provider.<span class="method">getCoin</span>(clanUuid, <span class="string">"clan"</span>, <span class="string">"gold"</span>).<span class="method">thenAccept</span>(balance -> {
        Bukkit.<span class="method">getLogger</span>().<span class="method">info</span>(<span class="string">"Clan Gold Balance: "</span> + balance);
    });

    <span class="comment">// --- 3. ADD COINS ---</span>
    <span class="comment">// Example: Add 50 "silver" to a Player</span>
    provider.<span class="method">addCoin</span>(playerUuid, <span class="string">"player"</span>, <span class="string">"silver"</span>, <span class="keyword">50</span>);

    <span class="comment">// --- 4. MINUS COINS ---</span>
    <span class="comment">// Example: Remove 100 default "coin" from a Guild</span>
    provider.<span class="method">minusCoin</span>(guildUuid, <span class="string">"guild"</span>, <span class="keyword">100</span>);

    <span class="comment">// --- 5. SET BALANCE ---</span>
    <span class="comment">// Example: Set a Player's "copper" balance to 500</span>
    provider.<span class="method">setCoin</span>(playerUuid, <span class="string">"player"</span>, <span class="string">"copper"</span>, <span class="keyword">500</span>);

    <span class="comment">// --- 6. SEND COINS (Transfer) ---</span>
    <span class="comment">// Example: Transfer 25 "gold" from a Player to a Clan</span>
    provider.<span class="method">sendCoin</span>(senderUuid, <span class="string">"player"</span>, receiverUuid, <span class="string">"clan"</span>, <span class="string">"gold"</span>, <span class="keyword">25</span>);

    <span class="comment">// --- 7. UTILITY ---</span>
    <span class="comment">// Example: Ensure a Clan account exists in DB (creates default if missing)</span>
    provider.<span class="method">ensureAccountExist</span>(clanUuid, <span class="string">"clan"</span>).<span class="method">thenAccept</span>(exists -> {
        <span class="keyword">if</span> (exists) Bukkit.<span class="method">getLogger</span>().<span class="method">info</span>(<span class="string">"Clan account is ready."</span>);
    });
}</pre>
        </div>
    </section>

        <section>
        <h2>2. Registering Subcommands (Addons)</h2>
        <p>Addons can register custom subcommands by accessing the Command Manager through the provider instance.</p>
        
        <div class="code-container">
            <div class="code-header">
                <span>Java</span>
                <span>AddonRegistration.java</span>
            </div>
            <pre>
<span class="comment">// 1. Retrieve the Provider</span>
<span class="class-name">MCEconomyProvider</span> provider = <span class="class-name">MCEconomyProvider</span>.<span class="method">getInstance</span>();

<span class="keyword">if</span> (provider != <span class="keyword">null</span>) {
    <span class="comment">// 2. Get the Command Manager</span>
    <span class="class-name">MCEconomyCommandManager</span> manager = provider.<span class="method">getCommandManager</span>();

    <span class="comment">// 3. Register your custom logic</span>
    manager.<span class="method">register</span>(<span class="string">"mycommand"</span>, <span class="keyword">new</span> <span class="class-name">MyCustomHandle</span>());
}</pre>
        </div>
    </section>

        <section>
        <h2>3. Registering Event Listeners (Addons)</h2>
        <p>Addons can register custom event listeners through the Listener Manager. This ensures the main plugin tracks all related listeners.</p>
        
        <div class="code-container">
            <div class="code-header">
                <span>Java</span>
                <span>ListenerRegistration.java</span>
            </div>
            <pre>
<span class="comment">// 1. Retrieve the Provider</span>
<span class="class-name">MCEconomyProvider</span> provider = <span class="class-name">MCEconomyProvider</span>.<span class="method">getInstance</span>();

<span class="keyword">if</span> (provider != <span class="keyword">null</span>) {
    <span class="comment">// 2. Get the Listener Manager</span>
    <span class="class-name">MCEconomyListenerManager</span> listenerManager = provider.<span class="method">getListenerManager</span>();

    <span class="comment">// 3. Register your custom listener</span>
    listenerManager.<span class="method">register</span>(<span class="keyword">new</span> <span class="class-name">MyCustomListener</span>());
}</pre>
        </div>
    </section>
    </main>

    <div id="footer-placeholder"></div>

    <script>
        const loadPartial = (id, path) => {
            fetch(path).then(res => res.text()).then(data => document.getElementById(id).innerHTML = data);
        };
        loadPartial('header-placeholder', '../partial/header.html');
        loadPartial('footer-placeholder', '../partial/footer.html');
    </script>
</body>
</html>
